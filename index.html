<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P5.js å…¨è¢å¹•èƒŒæ™¯èˆ‡éš±è—é¸å–®</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* CSS æ¨£å¼ */
        body {
            margin: 0;
            overflow: hidden; /* é˜²æ­¢æ»¾å‹•æ¢ */
            font-family: Arial, sans-serif;
        }

        /* 1. p5.js ç•«å¸ƒå®¹å™¨æ¨£å¼ */
        #p5-canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1; /* ç¢ºä¿ç•«å¸ƒåœ¨èƒŒæ™¯ */
        }

        /* 2. å´é‚Šæ¬„æ¨£å¼ */
        .sidebar {
            height: 100%; /* å…¨é«˜ */
            width: 0; /* é è¨­éš±è— */
            position: fixed;
            z-index: 10;
            top: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.85); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ */
            overflow-x: hidden;
            transition: 0.5s; /* éæ¸¡å‹•ç•« */
            padding-top: 60px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
        }

        .sidebar a {
            padding: 15px 10px 15px 32px;
            text-decoration: none;
            font-size: 20px;
            color: #f1f1f1;
            display: block;
            transition: 0.3s;
        }

        .sidebar a:hover {
            color: #7fc8f8; /* æ»‘é¼ æ‡¸åœé¡è‰² */
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* 3. ç®­é ­è§¸ç™¼å€åŸŸæ¨£å¼ */
        .openbtn-container {
            position: fixed;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            z-index: 9; /* ç•¥ä½æ–¼å´é‚Šæ¬„ */
            cursor: pointer;
            transition: left 0.5s;
        }

        .openbtn {
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 5px 15px 15px;
            font-size: 24px;
            border: none;
            border-radius: 0 5px 5px 0;
            /* ç®­é ­æ¨£å¼ */
            clip-path: polygon(0 0, 100% 50%, 0 100%);
            width: 25px;
            text-align: right;
        }

        /* å…§å®¹å€åŸŸ - å¯é¸ï¼Œç”¨æ–¼æ¨é–‹ä¸»å…§å®¹ */
        #main {
            transition: margin-left .5s;
            padding: 16px;
        }

    </style>
</head>
<body>

    <div id="p5-canvas-container"></div>

    <div id="mySidebar" class="sidebar">
        <a href="#" onclick="location.reload(); return false;">ğŸ  å›åˆ°é¦–é </a>
        <a href="#" onclick="showIframe('https://iluss1014.github.io/20251020/'); return false;">ğŸ–¼ï¸ ç¬¬ä¸€å–®å…ƒä½œå“</a>
        <a href="#" onclick="showIframe('https://hackmd.io/@AJTuK0sfSxauZjnp_1rk_Q/H1aMv7Aolx'); return false;">ğŸ“ ç¬¬ä¸€å–®å…ƒç­†è¨˜</a>
        <a href="#" onclick="showIframe('https://iluss1014.github.io/20251103/'); return false;">ğŸ’» æ¸¬é©—ç³»çµ±</a>
        <a href="#" onclick="showIframe('https://www.tku.edu.tw/'); return false;">ğŸ« æ·¡æ±Ÿå¤§å­¸</a>
        <a href="#" onclick="showIframe('https://www.et.tku.edu.tw/'); return false;">ğŸ“š æ•™è‚²ç§‘æŠ€ç³»</a>
    </div>

    <div id="openbtn-container" class="openbtn-container">
        <span class="openbtn">â—€</span>
    </div>

    <!-- åœ¨ body ä¸­ï¼Œmain div ä¹‹å‰åŠ å…¥ -->
    <div id="iframe-container" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 100; background-color: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.3);">
        <button onclick="closeIframe()" style="position: absolute; right: 10px; top: 10px; background: #ff6392; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">é—œé–‰</button>
        <iframe id="content-iframe" style="border: none;" width="100%" height="100%"></iframe>
    </div>

    <div id="main">
        </div>

    <script>
        // JavaScript è™•ç†å´é‚Šæ¬„çš„é¡¯ç¤º/éš±è—
        const sidebar = document.getElementById("mySidebar");
        const openBtnContainer = document.getElementById("openbtn-container");
        const main = document.getElementById("main");
        const sidebarWidth = '250px'; // å®šç¾©å´é‚Šæ¬„çš„å¯¬åº¦

        // è¨­ç½®ç®­é ­åˆå§‹ä½ç½®ï¼Œä½¿å…¶è²¼è‘—å·¦é‚Š
        openBtnContainer.style.left = '0px';

        // æ»‘é¼ é€²å…¥è§¸ç™¼å€åŸŸ
        openBtnContainer.addEventListener('mouseenter', () => {
            openNav();
        });

        // æ»‘é¼ é›¢é–‹å´é‚Šæ¬„å’Œè§¸ç™¼å€åŸŸæ™‚é—œé–‰
        document.addEventListener('mousemove', (event) => {
            // æª¢æŸ¥æ»‘é¼ æ˜¯å¦åœ¨å´é‚Šæ¬„æˆ–ç®­é ­å€åŸŸå…§
            const isOverSidebar = sidebar.contains(event.target);
            const isOverOpenBtn = openBtnContainer.contains(event.target);

            // å¦‚æœæ»‘é¼ ä¸åœ¨å´é‚Šæ¬„ä¸”ä¸åœ¨ç®­é ­å€åŸŸï¼Œå‰‡é—œé–‰
            if (!isOverSidebar && !isOverOpenBtn && sidebar.style.width === sidebarWidth) {
                // æª¢æŸ¥æ»‘é¼ æ˜¯å¦åœ¨å´é‚Šæ¬„ç¯„åœå…§ï¼Œå¦‚æœæ˜¯ï¼Œå‰‡ä¿æŒé–‹å•Ÿ
                if (event.clientX > parseInt(sidebarWidth)) {
                    // å¦‚æœæ»‘é¼ Xåº§æ¨™å¤§æ–¼å´é‚Šæ¬„å¯¬åº¦ï¼Œå‰‡é—œé–‰
                    closeNav();
                }
            }
        });

        // ä¹Ÿå¯ä»¥è®“å´é‚Šæ¬„æœ¬èº«åœ¨æ»‘é¼ é›¢é–‹æ™‚é—œé–‰
        sidebar.addEventListener('mouseleave', () => {
             closeNav();
        });


        function openNav() {
            sidebar.style.width = sidebarWidth;
            // å°‡ç®­é ­æ¨åˆ°å´é‚Šæ¬„å³é‚Šç·£ï¼Œä½†é€™è£¡æˆ‘å€‘è®“ç®­é ­éš±è—
            // openBtnContainer.style.left = sidebarWidth;
        }

        function closeNav() {
            sidebar.style.width = "0";
            openBtnContainer.style.left = '0px';
        }


        // --- P5.JS ç¨‹å¼ç¢¼é–‹å§‹ ---
        let colors = ['#7fc8f8', '#ffe45e', '#ff6392', '#17bebb'];
        let ctx;
        let motions = [];
        let motionClasses = [];
        let sceneTimer = 0;
        // èª¿æ•´ resetTime è®“å‹•ç•«å¾ªç’°æ…¢ä¸€é»ï¼Œé©åˆèƒŒæ™¯
        let resetTime = 60 * 15; // 15ç§’
        let fadeOutTime = 30;

        // å°‡ p5 ç•«å¸ƒé™„åŠ åˆ°æŒ‡å®šçš„ DOM å…ƒç´ 
        let p5Canvas;

        function setup() {
            // è®“ç•«å¸ƒå¡«æ»¿ç€è¦½å™¨è¦–çª—
            p5Canvas = createCanvas(windowWidth, windowHeight);
            p5Canvas.parent('p5-canvas-container'); // å°‡ç•«å¸ƒæ”¾å…¥å®¹å™¨ div
            rectMode(CENTER);
            ctx = drawingContext;
            INIT();
        }

        function windowResized() {
            // è¦–çª—å¤§å°æ”¹è®Šæ™‚ï¼Œé‡æ–°èª¿æ•´ç•«å¸ƒå¤§å°
            resizeCanvas(windowWidth, windowHeight);
            INIT(); // é‡æ–°åˆå§‹åŒ–ï¼Œè®“åœ–å½¢é©æ‡‰æ–°çš„å¤§å°

            // æ›´æ–° iframe å®¹å™¨å°ºå¯¸
            const container = document.getElementById('iframe-container');
            if (container.style.display !== 'none') {
                container.style.width = window.innerWidth * 0.7 + 'px';
                container.style.height = window.innerHeight * 0.85 + 'px';
            }
        }


        function draw() {
            background('#ffffff');
            for (let m of motions) {
                m.run();
            }

            // --- æ–°å¢çš„æ–‡å­—ç¹ªè£½ç¨‹å¼ç¢¼ ---
            // è¨­å®šæ–‡å­—æ¨£å¼
            fill(255); // ç™½è‰²
            noStroke();
            textAlign(CENTER, CENTER);
            textStyle(BOLD); // è¨­å®šç‚ºç²—é«”

            // æ ¹æ“šè¦–çª—å¤§å°èª¿æ•´æ–‡å­—å¤§å°ï¼Œè®“æ–‡å­—å…·å‚™éŸ¿æ‡‰å¼æ•ˆæœ
            // å°‡é™¤æ•¸å¾ 20 æ”¹ç‚º 15 ä¾†æ”¾å¤§å­—é«”
            let baseFontSize = min(windowWidth, windowHeight) / 15;
            textSize(baseFontSize);

            // è¨ˆç®—æ–‡å­—å‚ç›´ä½ç½®èˆ‡è¡Œé«˜
            let textY = windowHeight / 2;
            let lineHeight = baseFontSize * 1.2;

            // ç¹ªè£½ä¸‰è¡Œæ–‡å­—
            text("æ·¡æ±Ÿæ•™ç§‘ç³»", windowWidth / 2, textY - lineHeight);
            text("414730647", windowWidth / 2, textY);
            text("è˜‡å®¥ç¿", windowWidth / 2, textY + lineHeight);
            // --- æ–‡å­—ç¹ªè£½çµæŸ ---

            let alph = 0;
            if ((resetTime - fadeOutTime) < sceneTimer && sceneTimer <= resetTime) {
                alph = map(sceneTimer, (resetTime - fadeOutTime), resetTime, 0, 255);
                // ä½¿ç”¨ç™½è‰²åŠé€æ˜èƒŒæ™¯é€²è¡Œæ·¡å‡º
                background(255, alph);

            }

            if (frameCount % resetTime == 0) {
                INIT();
            }

            sceneTimer++;

        }

        function INIT() {
            sceneTimer = 0;
            motions = [];
            motionClasses = [Motion01, Motion02, Motion03, Motion04, Motion05];
            // ä½¿ç”¨ windowWidth å’Œ windowHeight
            let drawingRegion = min(windowWidth, windowHeight) * 0.75;
            let cellCount = 25;
            let cellSize = drawingRegion / cellCount;
            let clr = '#000000';
            for (let i = 0; i < cellCount; i++) {
                for (let j = 0; j < cellCount; j++) {
                    // ç¢ºä¿ç¶²æ ¼åœ¨ç•«å¸ƒä¸­å¤®
                    let startX = (windowWidth - drawingRegion) / 2;
                    let startY = (windowHeight - drawingRegion) / 2;
                    let x = cellSize * j + (cellSize / 2) + startX;
                    let y = cellSize * i + (cellSize / 2) + startY;

                    let MotionClass = random(motionClasses);
                    // æ ¹æ“šæ–°çš„ä¸­å¿ƒé»è¨ˆç®—å»¶é²
                    let t = -int(dist(x, y, windowWidth / 2, windowHeight / 2) * 0.7);
                    motions.push(new MotionClass(x, y, cellSize, t, clr));
                }
            }
        }

        function easeInOutQuint(x) {
            return x < 0.5 ? 16 * x * x * x * x * x : 1 - Math.pow(-2 * x + 2, 5) / 2;
        }

        // --- Agent å’Œ Motion Classes (èˆ‡æ‚¨çš„åŸå§‹ç¢¼ç›¸åŒ) ---

        class Agent {
            constructor(x, y, w, t, clr) {
                this.x = x;
                this.y = y;
                this.w = w;

                this.t1 = int(random(30, 100));
                this.t2 = this.t1 + int(random(30, 100));
                this.t = t;
                this.clr2 = color(clr);
                this.clr1 = color(random(colors));
                this.currentColor = this.clr1;
            }

            show() {
            }

            move() {
                if (0 < this.t && this.t < this.t1) {
                    let n = norm(this.t, 0, this.t1 - 1);
                    this.updateMotion1(easeInOutQuint(n));
                } else if (this.t1 < this.t && this.t < this.t2) {
                    let n = norm(this.t, this.t1, this.t2 - 1);
                    this.updateMotion2(easeInOutQuint(n));
                }
                this.t++;
            }

            run() {
                this.show();
                this.move();
            }

            updateMotion1(n) {

            }
            updateMotion2(n) {

            }

        }

        class Motion01 extends Agent {
            constructor(x, y, w, t, clr) {
                super(x, y, w, t, clr);
                this.shift = this.w * 3;
                this.ang = int(random(4)) * (TAU / 4);
                this.size = 0;
            }

            show() {
                noStroke();
                fill(this.currentColor);
                square(this.x + this.shift * cos(this.ang), this.y + this.shift * sin(this.ang), this.size);
            }

            updateMotion1(n) {
                this.shift = lerp(this.w * 3, 0, n);
                this.size = lerp(0, this.w, n);
                this.currentColor = lerpColor(this.clr1, this.clr2, n);
            }
             updateMotion2(n) {

            }
        }

        class Motion02 extends Agent {
            constructor(x, y, w, t, clr) {
                super(x, y, w, t, clr);
                this.shift = this.w * 2;
                this.ang = int(random(4)) * (TAU / 4);
                this.size = 0;
                this.corner = this.w / 2;
            }

            show() {
                noStroke();
                fill(this.currentColor);
                square(this.x + this.shift * cos(this.ang), this.y + this.shift * sin(this.ang), this.size, this.corner);
            }

            updateMotion1(n) {
                this.shift = lerp(0, this.w * 2, n);
                this.size = lerp(0, this.w / 2, n);
            }

            updateMotion2(n) {
                this.size = lerp(this.w / 2, this.w, n);
                this.shift = lerp(this.w * 2, 0, n);
                this.corner = lerp(this.w / 2, 0, n);
                this.currentColor = lerpColor(this.clr1, this.clr2, n);
            }
        }

        class Motion03 extends Agent {
            constructor(x, y, w, t, clr) {
                super(x, y, w, t, clr);
                this.shift = this.w * 2;
                this.ang = 0;
                this.size = 0
            }

            show() {
                push();
                translate(this.x, this.y);
                rotate(this.ang);
                noStroke();
                fill(this.currentColor);
                square(0, 0, this.size);
                pop();
            }

            updateMotion1(n) {
                this.ang = lerp(0, TAU, n);
                this.size = lerp(0, this.w, n);
                this.currentColor = lerpColor(this.clr1, this.clr2, n);

            }
             updateMotion2(n) {

            }
        }

        class Motion04 extends Agent {
            constructor(x, y, w, t, clr) {
                super(x, y, w, t, clr);
                this.shift = this.w * 2;
                this.ang = int(random(4)) * (TAU / 4);
                this.rot = PI;
                this.side = 0;
            }

            show() {
                push();
                translate(this.x, this.y);
                rotate(this.ang);
                translate(-this.w / 2, -this.w / 2);
                rotate(this.rot);
                fill(this.currentColor);
                rect(this.w / 2, (this.w / 2) - (this.w - this.side) / 2, this.w, this.side);
                pop();
            }

            updateMotion1(n) {
                this.side = lerp(0, this.w, n);
            }

            updateMotion2(n) {
                this.currentColor = lerpColor(this.clr1, this.clr2, n);
                this.rot = lerp(PI, 0, n);
            }
        }

        class Motion05 extends Agent {
            constructor(x, y, w, t, clr) {
                super(x, y, w, t, clr);
                this.shift = this.w / 2;
                this.size = 0;
            }

            show() {
                push();
                translate(this.x, this.y);
                for (let i = 0; i < 4; i++) {
                    fill(this.currentColor);
                    square((this.w / 4) + this.shift, (this.w / 4) + this.shift, this.size);
                    rotate(TAU / 4);
                }
                pop();
            }

            updateMotion1(n) {
                this.size = lerp(0, this.w / 4, n);
            }

            updateMotion2(n) {
                this.currentColor = lerpColor(this.clr1, this.clr2, n);
                this.shift = lerp(this.w / 2, 0, n);
                this.size = lerp(this.w / 4, this.w / 2, n);

            }
        }

        function showIframe(url) {
            const container = document.getElementById('iframe-container');
            const iframe = document.getElementById('content-iframe');

            // è¨­å®š iframe å®¹å™¨å°ºå¯¸ä¸¦ç«‹å³é¡¯ç¤ºï¼ˆç§»é™¤é–‹æ–°è¦–çª—çš„ fallbackï¼‰
            container.style.width = window.innerWidth * 0.7 + 'px';
            container.style.height = window.innerHeight * 0.85 + 'px';

            // æ¸…é™¤èˆŠäº‹ä»¶è™•ç†å™¨
            iframe.onload = null;
            iframe.onerror = null;

            // å˜—è©¦è¼‰å…¥ä¸¦é¡¯ç¤ºå®¹å™¨ï¼ˆå³ä½¿è¼‰å…¥è¢«ç€è¦½å™¨é˜»æ“‹ä¹Ÿä¸æœƒé–‹æ–°åˆ†é ï¼‰
            iframe.src = url;
            container.style.display = 'block';
            closeNav();
        }

        function closeIframe() {
            const container = document.getElementById('iframe-container');
            const iframe = document.getElementById('content-iframe');

            // æ¸…ç©ºä¸¦éš±è—
            iframe.onload = null;
            iframe.onerror = null;
            iframe.src = 'about:blank';
            container.style.display = 'none';
        }
    </script>

</body>
</html>